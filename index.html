

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management</title>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-database-compat.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f7f9fc; padding: 20px; }
        .container { max-width:1200px; margin: auto; }
        input, select, textarea, button { padding:8px; border-radius:4px; border:1px solid #ccc; }
        button { background:#0a74da; color:white; cursor:pointer; }
        button:hover { background:#095bb5; }

        table { width:100%; border-collapse:collapse; margin-top:15px; }
        th, td { padding:8px; border-bottom:1px solid #eee; }
        th { background-color:#f1f5fa; }

        .controls { visibility:hidden; display:flex; gap:5px; }
        tr:hover .controls { visibility:visible; }

        .status { padding:3px 7px; border-radius:4px; color:white; font-size:0.8em; }
        .Planned { background:#6c757d; }
        .InProgress { background:#ffc107; }
        .Completed { background:#28a745; }
    </style>
</head>
<body>
<div class="container">
    <h2>Project Management</h2>
    <div>
        <input id="project" placeholder="Project">
        <select id="customer">
            <option disabled selected>Select Customer</option>
            <option>Jube MNG</option><option>IBS Roofing</option><option>Zurix</option><option value="__new">Add Customer</option>
        </select>
        <input id="store" placeholder="Store">
        <select id="technician">
            <option disabled selected>Select Technician</option>
            <option>Arister</option><option>Elias</option><option>Gavino</option><option>David Romero</option><option value="__new">Add Technician</option>
        </select>
        <input id="date" type="date">
        <input id="due_date" type="date">
        <select id="status">
            <option value="Planned">Planned</option><option value="InProgress">In Progress</option><option value="Completed">Completed</option>
        </select>
        <textarea id="observations" placeholder="Observations"></textarea>
        <button onclick="addProject()">Add</button>
    </div>

    <table id="project-list">
        <thead>
            <tr>
                <th>‚ò∞</th><th>Project</th><th>Customer</th><th>Store</th><th>Technician</th>
                <th>Start</th><th>Due</th><th>Status</th><th>Observations</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCgSkYIvenfEzyjef50OD01Ox9et-nyBMo",
  authDomain: "fluxo-6d716.firebaseapp.com",
  databaseURL: "https://fluxo-6d716-default-rtdb.firebaseio.com",
  projectId: "fluxo-6d716",
  storageBucket: "fluxo-6d716.firebasestorage.app",
  messagingSenderId: "761253335013",
  appId: "1:761253335013:web:44c30372a4749203a3690c"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

function addProject(){
    const data={};
    ["project","customer","store","technician","date","due_date","status","observations"].forEach(id=>data[id]=document.getElementById(id).value);
    if(Object.values(data).slice(0,6).every(Boolean)){
        db.ref('projects').push(data);
        document.querySelectorAll("input,textarea,select").forEach(el=>el.value="");
    } else alert("Fill required fields.");
}

function loadProjects(){
    db.ref('projects').on('value',snap=>{
        const tbody=document.querySelector('#project-list tbody'); tbody.innerHTML="";
        snap.forEach(child=>{
            const p=child.val(),id=child.key;
            tbody.innerHTML+=`
            <tr data-id="${id}">
                <td class="controls">
                    <button onclick="editProject('${id}')">‚úèÔ∏è</button>
                    <button onclick="deleteProject('${id}')">üóëÔ∏è</button>
                    <button onclick="moveUp('${id}')">‚¨ÜÔ∏è</button>
                    <button onclick="moveDown('${id}')">‚¨áÔ∏è</button>
                </td>
                <td>${p.project}</td><td>${p.customer}</td><td>${p.store}</td>
                <td>${p.technician}</td><td>${p.date}</td><td>${p.due_date}</td>
                <td><span class="status ${p.status.replace(' ','')}">${p.status}</span></td>
                <td>${p.observations||'-'}</td>
            </tr>`;
        });
    });
}

function deleteProject(id){ db.ref(`projects/${id}`).remove(); }

function editProject(id){
    const row=document.querySelector(`[data-id='${id}']`).children;
    const data=["project","customer","store","technician","date","due_date","status","observations"];
    data.forEach((el,i)=>{
        const val=prompt(`Edit ${el}`,row[i+1].innerText);
        if(val) db.ref(`projects/${id}/${el}`).set(val);
    });
}

function swapNodes(n1,n2){n1.parentNode.insertBefore(n1,n2);}

function moveUp(id){
    const row=document.querySelector(`[data-id='${id}']`);
    if(row.previousElementSibling) swapNodes(row,row.previousElementSibling);
}

function moveDown(id){
    const row=document.querySelector(`[data-id='${id}']`);
    if(row.nextElementSibling) swapNodes(row.nextElementSibling,row);
}

window.onload=loadProjects;

document.getElementById('customer').onchange=function(){
    if(this.value=="__new"){
        const n=prompt("New customer:"); if(n)this.insertBefore(new Option(n,n,true,true),this.lastChild);
    }
};

document.getElementById('technician').onchange=function(){
    if(this.value=="__new"){
        const n=prompt("New technician:"); if(n)this.insertBefore(new Option(n,n,true,true),this.lastChild);
    }
};
</script>
</body>
</html>
